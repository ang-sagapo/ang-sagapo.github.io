<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/ang-32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/ang-16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="留校刷题喵">
<meta property="og:type" content="article">
<meta property="og:title" content="ctf密码er留校刷题">
<meta property="og:url" content="http://example.com/2022/12/21/ctf%E5%AF%86%E7%A0%81er%E7%95%99%E6%A0%A1%E5%88%B7%E9%A2%98/index.html">
<meta property="og:site_name" content="ang&#39;s blog">
<meta property="og:description" content="留校刷题喵">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20201027104312210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FvNTI0MjYwNTU=,size_16,color_FFFFFF,t_70#pic_center">
<meta property="article:published_time" content="2022-12-21T01:18:26.000Z">
<meta property="article:modified_time" content="2023-07-12T02:27:04.834Z">
<meta property="article:author" content="Ang">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20201027104312210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FvNTI0MjYwNTU=,size_16,color_FFFFFF,t_70#pic_center">

<link rel="canonical" href="http://example.com/2022/12/21/ctf%E5%AF%86%E7%A0%81er%E7%95%99%E6%A0%A1%E5%88%B7%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>ctf密码er留校刷题 | ang's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ang's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">en?</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/ang-sagapo" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/21/ctf%E5%AF%86%E7%A0%81er%E7%95%99%E6%A0%A1%E5%88%B7%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/ang.jpg">
      <meta itemprop="name" content="Ang">
      <meta itemprop="description" content="Why do learn?">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ang's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ctf密码er留校刷题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-12-21 09:18:26" itemprop="dateCreated datePublished" datetime="2022-12-21T09:18:26+08:00">2022-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-07-12 10:27:04" itemprop="dateModified" datetime="2023-07-12T10:27:04+08:00">2023-07-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Crypto/" itemprop="url" rel="index"><span itemprop="name">Crypto</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="留校刷题喵"><a href="#留校刷题喵" class="headerlink" title="留校刷题喵"></a>留校刷题喵</h1><span id="more"></span>

<h2 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h2><h4 id="1、"><a href="#1、" class="headerlink" title="1、"></a>1、</h4><p>base64：将byte数组编码为字符串，且编码出的字符串只包含ASCII基础字符，</p>
<h5 id="其中“-x3D-”号作为填充符。很关键，识别base64解密"><a href="#其中“-x3D-”号作为填充符。很关键，识别base64解密" class="headerlink" title="其中“&#x3D;”号作为填充符。很关键，识别base64解密"></a>其中“&#x3D;”号作为填充符。很关键，识别base64解密</h5><p>编码后的文本只包含64个ASCII字符（偶尔会加一个填充符&#x3D;）</p>
<p>base为了解决各个系统以及传输协议中二进制不兼容的问题而生的</p>
<h5 id="base算法实现过程：、"><a href="#base算法实现过程：、" class="headerlink" title="base算法实现过程：、"></a>base算法实现过程：、</h5><p>1、将原始数据每三个字节作为一组（24bit）</p>
<p>2、将24个bit分为4组（每组6个bit）</p>
<p>3、在每组前面补00，将其补成4组8个bit</p>
<p>4、根据base64码表得到扩展后每个字节的对应符号</p>
<p>结束<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Base64">https://zh.wikipedia.org/wiki/Base64</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/384238870">https://zhuanlan.zhihu.com/p/384238870</a></p>
<h5 id="当原文符号数不是三的倍数的时候，在后面补等于号（binggo！）"><a href="#当原文符号数不是三的倍数的时候，在后面补等于号（binggo！）" class="headerlink" title="当原文符号数不是三的倍数的时候，在后面补等于号（binggo！）"></a>当原文符号数不是三的倍数的时候，在后面补等于号（binggo！）</h5><h4 id="2、URL编码：（百分比编码）"><a href="#2、URL编码：（百分比编码）" class="headerlink" title="2、URL编码：（百分比编码）"></a>2、URL编码：（百分比编码）</h4><p>URL编码将字符串转换为可通过因特网传输的格式</p>
<p>URL只能使用ASCII字符集通过因特网进行发送</p>
<p>URL编码使用后跟16进制数字的%替代不安全的ASCII字符</p>
<p>URL不能包含空格，URL编码使用+或者%20 替代空格。</p>
<p><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/tags/html_ref_urlencode.asp">https://www.w3school.com.cn/tags/html_ref_urlencode.asp</a></p>
<h4 id="3、ROT13"><a href="#3、ROT13" class="headerlink" title="3、ROT13"></a>3、ROT13</h4><p>通过观察偏移量判断出凯斯密码</p>
<p>ROT13是它本身的逆反，同样的操作可同时用于加密和解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzNOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ROT13">https://zh.wikipedia.org/wiki/ROT13</a></p>
<p>偏移量为10：Avocat</p>
<p>-5：Cassis</p>
<p>-6：Cassette</p>
<h4 id="4、凯撒密码"><a href="#4、凯撒密码" class="headerlink" title="4、凯撒密码"></a>4、凯撒密码</h4><p>凯撒密码基础加密只会对字母进行偏移</p>
<p><img src="https://img-blog.csdnimg.cn/20201027104312210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FvNTI0MjYwNTU=,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<p>变异凯撒（自己找规律）</p>
<p>python：不可变数据类型：number，string，tuple（元组）</p>
<p>可变数据：列表（List）、字典、集合</p>
<p>python中不存在单个字符的类型，单个字符作为一个字符串来处理</p>
<h5 id="字符转ascii码：ord（）"><a href="#字符转ascii码：ord（）" class="headerlink" title="字符转ascii码：ord（）"></a>字符转ascii码：ord（）</h5><h5 id="数字转字符：chr（数字）"><a href="#数字转字符：chr（数字）" class="headerlink" title="数字转字符：chr（数字）"></a>数字转字符：chr（数字）</h5><h4 id="5、Quoted-printable编码"><a href="#5、Quoted-printable编码" class="headerlink" title="5、Quoted-printable编码"></a>5、Quoted-printable编码</h4><h4 id="6、rabbit加密"><a href="#6、rabbit加密" class="headerlink" title="6、rabbit加密"></a>6、rabbit加密</h4><p>这是一种高速流密码：使用一个128位密匙和一个64位初始化向量，由26个英文字母以及+ - * &#x2F; 组成</p>
<p>以U2FsdGVkX1开头</p>
<p>可能以等号结尾</p>
<h4 id="7、栅栏加密"><a href="#7、栅栏加密" class="headerlink" title="7、栅栏加密"></a>7、栅栏加密</h4><p>把要加密的明文分为N个为一组，然后把每组的第一个字连起来，形成一段无规律的话</p>
<h4 id="8、哈希函数"><a href="#8、哈希函数" class="headerlink" title="8、哈希函数"></a>8、哈希函数</h4><p>1md5转换：128bit 32位</p>
<p>SHA1：160bit 40位</p>
<p>SHA256：256bit 64位</p>
<p>SHA512：512bit 128位</p>
<h4 id="9、windows系统密码（hash文件）"><a href="#9、windows系统密码（hash文件）" class="headerlink" title="9、windows系统密码（hash文件）"></a>9、windows系统密码（hash文件）</h4><p>cmd打开文件命令：start</p>
<h5 id="windows认证体系：NTLM认证"><a href="#windows认证体系：NTLM认证" class="headerlink" title="windows认证体系：NTLM认证"></a>windows认证体系：NTLM认证</h5><p>NLTM-Hash：存储在SAM数据库及NTDS数据库中对密码进行hash摘要计算后的结</p>
<p>数字转中文：unicode编码、中文电码</p>
<h4 id="10、猪圈密码（草）when-the-pig-want-treat"><a href="#10、猪圈密码（草）when-the-pig-want-treat" class="headerlink" title="10、猪圈密码（草）when the pig want treat"></a>10、猪圈密码（草）when the pig want treat</h4><h2 id="Day2"><a href="#Day2" class="headerlink" title="Day2"></a>Day2</h2><h4 id="11、dp-amp-dq泄露"><a href="#11、dp-amp-dq泄露" class="headerlink" title="11、dp&amp;dq泄露"></a>11、dp&amp;dq泄露</h4><p>在这里终于补上了一些东西：</p>
<p>1、欧几里得与扩展欧几里得（用python写递归好抽象。。。）</p>
<p>2、利用费马小定理求逆元时用到的快速幂算法</p>
<h4 id="快速幂算法："><a href="#快速幂算法：" class="headerlink" title="快速幂算法："></a>快速幂算法：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;保留最后的三位，所以要对1000取余&#x27;&#x27;&#x27;</span></span><br><span class="line">mod = <span class="number">1000</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fastpower</span>(<span class="params">a,b</span>):</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b&gt;<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span>(b%<span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">            b//=<span class="number">2</span></span><br><span class="line">            a = a*a%mod</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            b = b-<span class="number">1</span></span><br><span class="line">            ans = ans*a%mod</span><br><span class="line">            b//=<span class="number">2</span></span><br><span class="line">            a = a*a%mod</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(fastpower(<span class="number">2</span>,<span class="number">1000000000</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;下面再对快速幂算法进行优化&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fasterpower</span>(<span class="params">a,b</span>):</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> b &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> b%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            ans = ans*a%mod</span><br><span class="line">        b//=<span class="number">2</span> </span><br><span class="line">        a = a*a%mod</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">ans = fasterpower(<span class="number">2</span>,<span class="number">1000000000</span>)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>



<h5 id="这里是一个给出dp，dq，c，p，q但是并没有给出e的题目，属于dp和dq双泄露但是并没有给定密钥"><a href="#这里是一个给出dp，dq，c，p，q但是并没有给出e的题目，属于dp和dq双泄露但是并没有给定密钥" class="headerlink" title="这里是一个给出dp，dq，c，p，q但是并没有给出e的题目，属于dp和dq双泄露但是并没有给定密钥"></a>这里是一个给出dp，dq，c，p，q但是并没有给出e的题目，属于dp和dq双泄露但是并没有给定密钥</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">inv_p = inverse(p,q)</span><br><span class="line">k = ((m2-m1)%q)*inv_p%q</span><br><span class="line">m = (k*p+m1)%(p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="12、共模攻击"><a href="#12、共模攻击" class="headerlink" title="12、共模攻击"></a>12、共模攻击</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a,b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a,<span class="number">1</span>,<span class="number">0</span></span><br><span class="line">    r,x,y = exgcd(b,a%b)</span><br><span class="line">    k = a//b</span><br><span class="line">    temp = x</span><br><span class="line">    x = y</span><br><span class="line">    y = temp - k*y</span><br><span class="line">    <span class="keyword">return</span> r,x,y</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fastpower</span>(<span class="params">a,b,mod</span>):</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(b &gt; <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> b%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            ans = ans*a%mod</span><br><span class="line">        a = a*a%mod</span><br><span class="line">        b//=<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">public_mod</span>(<span class="params">c1,c2,e1,e2,n</span>):</span><br><span class="line">    r,s1,s2 = exgcd(e1,e2)</span><br><span class="line">    <span class="built_in">print</span>(r,s1,s2)</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = -s1</span><br><span class="line">        c1 = inverse(c1,n)</span><br><span class="line">    <span class="keyword">if</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = -s2</span><br><span class="line">        c2 = inverse(c2,n)</span><br><span class="line"></span><br><span class="line">    m = <span class="built_in">pow</span>(c1,s1,n)*(<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m = public_mod(c1,c2,e1,e2,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br></pre></td></tr></table></figure>



<h4 id="13、Unencode编码："><a href="#13、Unencode编码：" class="headerlink" title="13、Unencode编码："></a>13、Unencode编码：</h4><p>编码算法：将三个字符顺序放入一个24位的缓冲区，缺字符的地方补零，然后将缓冲区截断为4个部分，高位在先，每个部分6位，用专门的64个字符重新表示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“`!”<span class="comment">#$%&amp;’()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_”</span></span><br></pre></td></tr></table></figure>

<p>在文件的开头有”begin xxx(被编码的文件名)</p>
<p>在文件的结尾有”end“用于标志Uue文件的开始与结束</p>
<p>编码时，每次读取源文件的45个字符，不足45个的用”NULL”补足为3的整数倍，然后输入目标文件一个ASCII为：</p>
<p>32+实际读取的字符数”的字符作为每一行的开始。读取的字符编码后输入目标文件，再输入一个“换行符”。如果源文件被编码完了，那么输入“&#96;（ASCII为96）”和一个“换行符”表示编码结束。</p>
<p>解码时它将4个字符分别转换为4个6位字符后，截取有用的后六位放入一个 24 位的缓冲区，即得3个二进制代码。</p>
<h4 id="14、dp泄露"><a href="#14、dp泄露" class="headerlink" title="14、dp泄露"></a>14、dp泄露</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_leak</span>(<span class="params">e,dp,n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">        <span class="keyword">if</span>(dp*e - <span class="number">1</span>)%i == <span class="number">0</span>:</span><br><span class="line">            p = (dp*e - <span class="number">1</span>)//i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">                q = n//p</span><br><span class="line">                <span class="keyword">return</span> p,q</span><br><span class="line">    </span><br><span class="line">p,q = dp_leak(e,dp,n)</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">        </span><br></pre></td></tr></table></figure>



<h2 id="Day3"><a href="#Day3" class="headerlink" title="Day3"></a>Day3</h2><h4 id="15、十六进制转为字符串"><a href="#15、十六进制转为字符串" class="headerlink" title="15、十六进制转为字符串"></a>15、十六进制转为字符串</h4><p>可以直接用函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;61666374667B317327745F73305F333435797D&#x27;</span></span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(c).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>可以选择base16编码的函数来解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">hex_str = <span class="string">&#x27;7468616e6b20796f752076657279206d75636821&#x27;</span> </span><br><span class="line"><span class="built_in">print</span>(base64.b16decode(hex_str.upper()))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>字符串转为16进制：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_char = char.encode().<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(char + <span class="string">&quot; 的十六进制序列是：&quot;</span> + _char)</span><br></pre></td></tr></table></figure>

<h4 id="16、"><a href="#16、" class="headerlink" title="16、"></a>16、</h4><p>字符串转为二进制</p>
<p>二进制进行异或操作</p>
<p>二进制转为16进制</p>
<p>16进制转为字符串</p>
<h5 id="bytes-from-hex-s"><a href="#bytes-from-hex-s" class="headerlink" title="bytes.from(hex(s))"></a>bytes.from(hex(s))</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join([<span class="built_in">bin</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="built_in">int</span>(b, <span class="number">2</span>) <span class="keyword">for</span> b <span class="keyword">in</span> s.split(<span class="string">&#x27; &#x27;</span>)]])</span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">&#x27;ἇ̀Ј唒ဃ塔屋䩘卖剄䐃堂ن䝔嘅均ቄ䩝ᬔ&#x27;</span></span><br><span class="line">s2 = <span class="string">&#x27;asadsasdasdasdasdasdasdasdasdasdqwesqf&#x27;</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="string">&#x27;1111100000111 1100000000 10000001000 101010100010010 1000000000011 101100001010100 101110001001011 100101001011000 101001101010110 101001001000100 100010000000011 101100000000010 11001000110 100011101010100 101011000000101 101011101000111 1001001000100 100101001011101 1101100010100&#x27;</span></span><br><span class="line">c1 = c1.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">c2 = <span class="string">&#x27;1100001 1110011 1100001 1100100 1110011 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1100001 1110011 1100100 1110001 1110111 1100101 1110011 1110001 1100110&#x27;</span></span><br><span class="line">c2 = c2.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">a = <span class="string">&#x27;0110000101110011011000010110010001110011011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011100010111011101100101011100110111000101100110&#x27;</span></span><br><span class="line">b = <span class="string">&#x27;0000011100011111000000000000001100001000000001000001001001010101000000110001000001010100010110000100101101011100010110000100101001010110010100110100010001010010000000110100010000000010010110000100011000000110010101000100011100000101010101100100011101010111010001000001001001011101010010100001010000011011&#x27;</span></span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span>(a[i] == b[i]):</span><br><span class="line">        c+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">m = <span class="built_in">hex</span>(<span class="built_in">int</span>(c,<span class="number">2</span>))</span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(m[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>下面附上进制转换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">任意进制转为<span class="number">10</span>进制：</span><br><span class="line"><span class="built_in">int</span>(s,待转换进制)</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>进制转为<span class="number">16</span>进制：</span><br><span class="line"><span class="built_in">hex</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="number">10</span>进制转为<span class="number">2</span>进制</span><br><span class="line"><span class="built_in">bin</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="number">16</span>进制转为<span class="number">2</span>进制：</span><br><span class="line">先要<span class="number">16</span>进制转为<span class="number">10</span>进制再将<span class="number">10</span>进制转为<span class="number">2</span>进制</span><br><span class="line"></span><br><span class="line">任意进制转为<span class="number">8</span>进制</span><br><span class="line"><span class="built_in">oct</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="number">16</span>进制转为字符串</span><br><span class="line"><span class="built_in">bytes</span>.fromhex(s).decode()</span><br></pre></td></tr></table></figure>

<h4 id="17、给出两个文件flag-enc-密文-以及pub-key-公钥"><a href="#17、给出两个文件flag-enc-密文-以及pub-key-公钥" class="headerlink" title="17、给出两个文件flag.enc(密文)以及pub.key(公钥)"></a>17、给出两个文件flag.enc(密文)以及pub.key(公钥)</h4><p>首先根据公钥解出n以及e的具体值</p>
<p>利用openssl？但是还没有仔细看，下次一定看呜呜呜</p>
<p>google得到可以利用python自带的库，又学到了一个新模板Crypto.PublicKey.RSA</p>
<p>直接应用RSA中的importkey函数导入文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public_key = RSA.importKey(<span class="built_in">open</span>(<span class="string">r&quot;C:\Users\20191\Desktop\pub.key&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).read())</span><br></pre></td></tr></table></figure>

<p>然后可以yafu将n进行分解p和q</p>
<p>利用rsa库可以得到私钥:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;private.pem&#x27;</span>, mode=<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> privatefile:</span><br><span class="line">	keydata = privatefile.read()</span><br><span class="line">privkey = rsa.PrivateKey.load_pkcs1(keydata)</span><br><span class="line"></span><br><span class="line">具体操作如下：</span><br><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line">(pubkey, privkey) = rsa.newkeys(<span class="number">512</span>)  <span class="comment"># 创建公钥和私钥，512为设定你加密字符串的最大可支持加密长度为512位=64字节，你也可以按需设置任意长度，越长加密越慢，越短越快</span></span><br><span class="line"><span class="comment"># 将公钥和私钥以pem编码格式保存</span></span><br><span class="line">pub = pubkey.save_pkcs1()</span><br><span class="line">pri = privkey.save_pkcs1()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;公钥初始的值为：<span class="subst">&#123;pubkey&#125;</span>，以pem格式的保存后的数据为：<span class="subst">&#123;pub&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;私钥初始的值为：<span class="subst">&#123;privkey&#125;</span> \n 以pem格式的保存后的私钥数据为：<span class="subst">&#123;pri&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#  打印结果</span></span><br><span class="line"><span class="comment"># 公钥初始的值为：PublicKey(7481244465315159030174941866408088977078689270761513884333182534899112302828868853012354970827459273420757239091319237996571359037764144367408861808720513, 65537) </span></span><br><span class="line"><span class="comment"># 以pem格式的保存后的公钥数据为：b&#x27;-----BEGIN RSA PUBLIC KEY-----\nMEgCQQCO14+r/YbVU9gmeglgJoi8PNUvVaLzRFOBi/dNN5muCB6kRCzBylNhWpMi\nGAKy+wNjY/V1JKp7eILkc3KyMHqBAgMBAAE=\n-----END RSA PUBLIC KEY-----\n&#x27;</span></span><br><span class="line"><span class="comment"># 私钥初始的值为：PrivateKey(7481244465315159030174941866408088977078689270761513884333182534899112302828868853012354970827459273420757239091319237996571359037764144367408861808720513, 65537, 3506665680913321791475716605798100085247726562224742435766529354251275320158796528099874018589937145723483840242318255274732417780923351826009689191428353, 5643184159408851232131776560683191883064718200648061020021754396931515736448351153, 1325713330273249992945906759133446589093679828123455507108369540590727121) </span></span><br><span class="line"><span class="comment"># 以pem格式的保存后的私钥数据为：b&#x27;-----BEGIN RSA PRIVATE KEY-----\nMIIBPAIBAAJBAI7Xj6v9htVT2CZ6CWAmiLw81S9VovNEU4GL9003ma4IHqRELMHK\nU2FakyIYArL7A2Nj9XUkqnt4guRzcrIweoECAwEAAQJAQvQ5jNWeYNoXJBnp0R7e\n0tT03GYYpkxtk/iGZ7RaxGNXkIecc0u+bg4kSXC8BpcxpVS7xqWIPO4+ognbOkUx\nAQIjAL5ffVWlM15Ijcy5isAEzO6UnspteTYaA1H098CNMrSgu7ECHwDAFXC9M3X5\nKGM7tRw7/Vb7hroNJ23crvKG7Y/N79ECImrGeC/PRq59FztaXd4xUxgFt8JmAHQ9\nxtrzAPq4t1XkSSECHwCEbkPMLi6oGbBQ+gz9Ty0pPToI16ZnADc1z5PV6AECIhGm\n7Hx73R+hCWXIih/bttl0W7hl6mlIOqZXo30IfFUPHtQ=\n-----END RSA PRIVATE KEY-----\n&#x27;</span></span><br><span class="line"><span class="comment"># 将公钥保存到文件 ,将字节写入文件需要加上decode（&#x27;utf-8&#x27;），python3新增</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.pub&quot;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> file:  <span class="comment"># public.pub，保存的文件名，可更改路径，这里保存在当前路径下</span></span><br><span class="line">    file.write(pub.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="comment"># 将私钥保存到文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private.pem&quot;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(pri.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 取出公钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;public.pub&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file_pub:</span><br><span class="line">	<span class="comment"># 从文件中读出数据</span></span><br><span class="line">    pub_data = file_pub.read()</span><br><span class="line">    <span class="comment"># 将读出数据通过PublicKey.load_pkcs1()转换为公钥</span></span><br><span class="line">    pubkey = rsa.PublicKey.load_pkcs1(pub_data)</span><br><span class="line"><span class="comment"># 取出私钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private.pub&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file_pri:</span><br><span class="line">    pri_data = file_pri.read()</span><br><span class="line">    <span class="comment"># 将读出数据通过PrivateKey.load_pkcs1()转换为私钥</span></span><br><span class="line">    prikey = rsa.PrivateKey.load_pkcs1(pri_data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>rsa加解密过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># rsa加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsaEncrypt</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    <span class="comment"># 生成公钥、私钥</span></span><br><span class="line">    (pubkey, privkey) = rsa.newkeys(<span class="number">512</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;公钥:\n%s\n私钥:\n:%s&quot;</span> % (pubkey, privkey))</span><br><span class="line">    <span class="comment"># 明文编码格式</span></span><br><span class="line">    content = <span class="built_in">str</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="comment"># 公钥加密</span></span><br><span class="line">    crypto = rsa.encrypt(content, pubkey)</span><br><span class="line">    <span class="keyword">return</span> (crypto, privkey)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># rsa解密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsaDecrypt</span>(<span class="params"><span class="built_in">str</span>, pk</span>):</span><br><span class="line">    <span class="comment"># 私钥解密</span></span><br><span class="line">    content = rsa.decrypt(<span class="built_in">str</span>, pk)</span><br><span class="line">    con = content.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> con</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">str</span>, pk = rsaEncrypt(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;加密后密文：\n%s&quot;</span> % <span class="built_in">str</span>)</span><br><span class="line">    content = rsaDecrypt(<span class="built_in">str</span>, pk)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后明文：\n%s&quot;</span> % content)</span><br></pre></td></tr></table></figure>

<p>python文件操作：<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/article/25704283.html%E3%80%81">https://www.w3cschool.cn/article/25704283.html、</a></p>
<h1 id="Day4"><a href="#Day4" class="headerlink" title="Day4"></a>Day4</h1><h4 id="18、Rsaroll"><a href="#18、Rsaroll" class="headerlink" title="18、Rsaroll"></a>18、Rsaroll</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p =  <span class="number">49891</span></span><br><span class="line">q =  <span class="number">18443</span></span><br><span class="line">e = <span class="number">19</span></span><br><span class="line">n = p*q</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi_n)</span><br><span class="line">c  = [<span class="number">704796792</span>,<span class="number">752211152</span>,<span class="number">274704164</span>,<span class="number">18414022</span>,<span class="number">368270835</span>,<span class="number">483295235</span>,<span class="number">263072905</span>,<span class="number">459788476</span>,<span class="number">483295235</span>,<span class="number">459788476</span>,<span class="number">663551792</span>,<span class="number">475206804</span>,<span class="number">459788476</span>,<span class="number">428313374</span>,<span class="number">475206804</span>,<span class="number">459788476</span>,<span class="number">425392137</span>,<span class="number">704796792</span>,<span class="number">458265677</span>,<span class="number">341524652</span>,<span class="number">483295235</span>,<span class="number">534149509</span>,<span class="number">425392137</span>,<span class="number">428313374</span>,<span class="number">425392137</span>,<span class="number">341524652</span>,<span class="number">458265677</span>,<span class="number">263072905</span>,<span class="number">483295235</span>,<span class="number">828509797</span>,<span class="number">341524652</span>,<span class="number">425392137</span>,<span class="number">475206804</span>,<span class="number">428313374</span>,<span class="number">483295235</span>,<span class="number">475206804</span>,<span class="number">459788476</span>,<span class="number">306220148</span>,]</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> temp <span class="keyword">in</span> c:</span><br><span class="line">    temp_flag = <span class="built_in">pow</span>(temp,d,n)</span><br><span class="line">    temp_flag = long_to_bytes(temp_flag)</span><br><span class="line">    flag = flag + temp_flag</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="19、低指数攻击（e-x3D-3）"><a href="#19、低指数攻击（e-x3D-3）" class="headerlink" title="19、低指数攻击（e &#x3D; 3）"></a>19、低指数攻击（e &#x3D; 3）</h4><p>直接对k进行递增循环，从0开始，判断开方之后是否为整数，如果为整数则退出循环。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line"></span><br><span class="line">e= <span class="built_in">int</span>(<span class="string">&#x27;0x3&#x27;</span>,<span class="number">16</span>)</span><br><span class="line">c= <span class="built_in">int</span>(<span class="string">&#x27;0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365&#x27;</span>,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(n,e,c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">little_crt</span>(<span class="params">c,e,n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        flag = gmpy2.iroot(c+k*n,<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span> flag[<span class="number">1</span>] == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> flag[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m = little_crt(c,e,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h4 id="20、babyRSA"><a href="#20、babyRSA" class="headerlink" title="20、babyRSA"></a>20、babyRSA</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;*****************&quot;</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">262248800182277040650192055439906580479</span></span><br><span class="line">q = <span class="number">262854994239322828547925595487519915551</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65533</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">c = <span class="number">27565231154623519221597938803435789010285480123476977081867877272451638645710</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 27565231154623519221597938803435789010285480123476977081867877272451638645710</span></span><br></pre></td></tr></table></figure>

<h4 id="21、Playfair加密"><a href="#21、Playfair加密" class="headerlink" title="21、Playfair加密"></a>21、Playfair加密</h4><p><a target="_blank" rel="noopener" href="http://www.metools.info/code/playfair_186.html">http://www.metools.info/code/playfair_186.html</a> 现在属于是想把这些奇奇怪怪的加密和解密算法都实现一下，但是好难，还是先刷题吧</p>
<p>膜大佬的加解密实现原理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#########################Playfair密码#########################</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#约定1：若明文字母数量为奇数，在明文末尾添加一个&#x27;Z&#x27;</span></span><br><span class="line"><span class="comment">#约定2：&#x27;I&#x27;作为&#x27;J&#x27;来处理</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#字母表</span></span><br><span class="line">letter_list=<span class="string">&#x27;ABCDEFGHJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#密码表</span></span><br><span class="line">T_letter=[<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>]</span><br><span class="line"> </span><br><span class="line"><span class="comment">#根据密钥建立密码表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Create_Matrix</span>(<span class="params">key</span>):</span><br><span class="line">  key=Remove_Duplicates(key)  <span class="comment">#移除密钥中的重复字母</span></span><br><span class="line">  key=key.replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>) <span class="comment">#去除密钥中的空格</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span> ch <span class="keyword">in</span> letter_list:  <span class="comment">#根据密钥获取新组合的字母表</span></span><br><span class="line">    <span class="keyword">if</span> ch <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">      key+=ch</span><br><span class="line">  </span><br><span class="line">  j=<span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)): <span class="comment">#将新的字母表里的字母逐个填入密码表中，组成5*5的矩阵</span></span><br><span class="line">    T_letter[j]+=key[i]     <span class="comment">#j用来定位字母表的行</span></span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>==(i+<span class="number">1</span>)%<span class="number">5</span>:</span><br><span class="line">      j+=<span class="number">1</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#移除字符串中重复的字母</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Remove_Duplicates</span>(<span class="params">key</span>):</span><br><span class="line">  key=key.upper() <span class="comment">#转成大写字母组成的字符串</span></span><br><span class="line">  _key=<span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">for</span> ch <span class="keyword">in</span> key:</span><br><span class="line">    <span class="keyword">if</span> ch==<span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">      ch=<span class="string">&#x27;J&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> ch <span class="keyword">in</span> _key:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      _key+=ch</span><br><span class="line">  <span class="keyword">return</span> _key</span><br><span class="line"> </span><br><span class="line"><span class="comment">#获取字符在密码表中的位置</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_MatrixIndex</span>(<span class="params">ch</span>):</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T_letter)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T_letter)):</span><br><span class="line">      <span class="keyword">if</span> ch==T_letter[i][j]:</span><br><span class="line">        <span class="keyword">return</span> i,j <span class="comment">#i为行，j为列</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext,T_letter</span>):</span><br><span class="line">  ciphertext=<span class="string">&#x27;&#x27;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(plaintext) % <span class="number">2</span> !=<span class="number">0</span>:  <span class="comment">#如果新的明文长度为奇数，在其末尾添上&#x27;Z&#x27;</span></span><br><span class="line">    plaintext+=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">  </span><br><span class="line">  i=<span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> i&lt;<span class="built_in">len</span>(plaintext): <span class="comment">#对明文进行遍历</span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>==plaintext[i].isalpha():  <span class="comment">#如果是明文是字母的话，</span></span><br><span class="line">      j=i+<span class="number">1</span>                           <span class="comment">#则开始对该字母之后的明文进行遍历，</span></span><br><span class="line">      <span class="keyword">while</span> j&lt;<span class="built_in">len</span>(plaintext):         <span class="comment">#直到遍历到字母，进行加密</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span>==plaintext[j].isalpha():</span><br><span class="line">          <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span>==plaintext[i].upper():             <span class="comment">#</span></span><br><span class="line">            x=Get_MatrixIndex(<span class="string">&#x27;J&#x27;</span>)                  <span class="comment">#</span></span><br><span class="line">          <span class="keyword">else</span>:                                     <span class="comment">#</span></span><br><span class="line">            x=Get_MatrixIndex(plaintext[i].upper()) <span class="comment">#对字符在密码表中的坐标</span></span><br><span class="line">          <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span>==plaintext[j].upper():             <span class="comment">#进行定位,同时将&#x27;I&#x27;作为</span></span><br><span class="line">              y=Get_MatrixIndex(<span class="string">&#x27;J&#x27;</span>)                <span class="comment">#&#x27;J&#x27;来处理</span></span><br><span class="line">          <span class="keyword">else</span>:                                     <span class="comment">#</span></span><br><span class="line">            y=Get_MatrixIndex(plaintext[j].upper()) <span class="comment">#</span></span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span> x[<span class="number">0</span>]==y[<span class="number">0</span>]:    <span class="comment">#如果在同一行</span></span><br><span class="line">            ciphertext+=T_letter[x[<span class="number">0</span>]][(x[<span class="number">1</span>]+<span class="number">1</span>)%<span class="number">5</span>]+T_letter[y[<span class="number">0</span>]][(y[<span class="number">1</span>]+<span class="number">1</span>)%<span class="number">5</span>]</span><br><span class="line">          <span class="keyword">elif</span> x[<span class="number">1</span>]==y[<span class="number">1</span>]:  <span class="comment">#如果在同一列</span></span><br><span class="line">            ciphertext+=T_letter[(x[<span class="number">1</span>]+<span class="number">1</span>)%<span class="number">5</span>][x[<span class="number">0</span>]]+T_letter[(y[<span class="number">1</span>]+<span class="number">1</span>)%<span class="number">5</span>][y[<span class="number">0</span>]]</span><br><span class="line">          <span class="keyword">else</span>:             <span class="comment">#如果不同行不同列</span></span><br><span class="line">            ciphertext+=T_letter[x[<span class="number">0</span>]][y[<span class="number">1</span>]]+T_letter[y[<span class="number">0</span>]][x[<span class="number">1</span>]]</span><br><span class="line">          <span class="keyword">break</span>;  <span class="comment">#每组明文对加密完成后，结束本次对明文的遍历</span></span><br><span class="line">        j+=<span class="number">1</span></span><br><span class="line">      i=j+<span class="number">1</span>  <span class="comment">#每次对明文的遍历是从加密过后的明文的后一个明文开始的,结束本次循环</span></span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      ciphertext+=plaintext[i]  <span class="comment">#如果明文不是字母，直接加到密文上</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> ciphertext</span><br><span class="line"> </span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">ciphertext,T_letter</span>):</span><br><span class="line">  plaintext=<span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">len</span>(ciphertext) % <span class="number">2</span> !=<span class="number">0</span>:  <span class="comment">#如果新的密文长度为奇数，在其末尾添上&#x27;Z&#x27;</span></span><br><span class="line">    ciphertext+=<span class="string">&#x27;Z&#x27;</span></span><br><span class="line">  </span><br><span class="line">  i=<span class="number">0</span></span><br><span class="line">  <span class="keyword">while</span> i&lt;<span class="built_in">len</span>(ciphertext): <span class="comment">#对密文进行遍历</span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>==ciphertext[i].isalpha():  <span class="comment">#如果是密文是字母的话，</span></span><br><span class="line">      j=i+<span class="number">1</span>                            <span class="comment">#则开始对该字母之后的密文进行遍历，</span></span><br><span class="line">      <span class="keyword">while</span> j&lt;<span class="built_in">len</span>(ciphertext):         <span class="comment">#直到遍历到字母，进行解密</span></span><br><span class="line">        <span class="keyword">if</span> <span class="literal">True</span>==ciphertext[j].isalpha():</span><br><span class="line">          <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span>==ciphertext[i].upper():              <span class="comment">#</span></span><br><span class="line">            x=Get_MatrixIndex(<span class="string">&#x27;J&#x27;</span>)                    <span class="comment">#</span></span><br><span class="line">          <span class="keyword">else</span>:                                       <span class="comment">#</span></span><br><span class="line">            x=Get_MatrixIndex(ciphertext[i].upper())  <span class="comment">#对字符在密码表中的坐标</span></span><br><span class="line">          <span class="keyword">if</span> <span class="string">&#x27;I&#x27;</span>==ciphertext[j].upper():              <span class="comment">#进行定位,同时将&#x27;I&#x27;作为</span></span><br><span class="line">              y=Get_MatrixIndex(<span class="string">&#x27;J&#x27;</span>)                  <span class="comment">#&#x27;J&#x27;来处理</span></span><br><span class="line">          <span class="keyword">else</span>:                                       <span class="comment">#</span></span><br><span class="line">            y=Get_MatrixIndex(ciphertext[j].upper())  <span class="comment">#</span></span><br><span class="line">          </span><br><span class="line">          <span class="keyword">if</span> x[<span class="number">0</span>]==y[<span class="number">0</span>]:    <span class="comment">#如果在同一行</span></span><br><span class="line">            plaintext+=T_letter[x[<span class="number">0</span>]][(x[<span class="number">1</span>]-<span class="number">1</span>)%<span class="number">5</span>]+T_letter[y[<span class="number">0</span>]][(y[<span class="number">1</span>]-<span class="number">1</span>)%<span class="number">5</span>]</span><br><span class="line">          <span class="keyword">elif</span> x[<span class="number">1</span>]==y[<span class="number">1</span>]:  <span class="comment">#如果在同一列</span></span><br><span class="line">            plaintext+=T_letter[(x[<span class="number">1</span>]-<span class="number">1</span>)%<span class="number">5</span>][x[<span class="number">0</span>]]+T_letter[(y[<span class="number">1</span>]-<span class="number">1</span>)%<span class="number">5</span>][y[<span class="number">0</span>]]</span><br><span class="line">          <span class="keyword">else</span>:             <span class="comment">#如果不同行不同列</span></span><br><span class="line">            plaintext+=T_letter[x[<span class="number">0</span>]][y[<span class="number">1</span>]]+T_letter[y[<span class="number">0</span>]][x[<span class="number">1</span>]]</span><br><span class="line">          <span class="keyword">break</span>;  <span class="comment">#每组密文对解密完成后，结束本次对密文的遍历</span></span><br><span class="line">        j+=<span class="number">1</span></span><br><span class="line">      i=j+<span class="number">1</span>  <span class="comment">#每次对密文的遍历是从解密过后的密文的后一个密文开始的,结束本次循环</span></span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      plaintext+=ciphertext[i]  <span class="comment">#如果密文不是字母，直接加到明文上</span></span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">  <span class="keyword">return</span> plaintext</span><br><span class="line"> </span><br><span class="line"><span class="comment">#主函数</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;加密请按D,解密请按E:&quot;</span>)</span><br><span class="line">  user_input=<span class="built_in">input</span>();</span><br><span class="line">  <span class="keyword">while</span>(user_input!=<span class="string">&#x27;D&#x27;</span> <span class="keyword">and</span> user_input!=<span class="string">&#x27;E&#x27;</span>):<span class="comment">#输入合法性检测</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;输入有误!请重新输入:&quot;</span>)</span><br><span class="line">    user_input=<span class="built_in">input</span>()</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;请输入密钥，密钥由英文字母组成:&#x27;</span>)</span><br><span class="line">  key=<span class="built_in">input</span>()</span><br><span class="line">  </span><br><span class="line">  Create_Matrix(key)  <span class="comment">#建立密码表</span></span><br><span class="line"> </span><br><span class="line">  <span class="keyword">if</span> user_input==<span class="string">&#x27;D&#x27;</span>: <span class="comment">#加密</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;请输入明文:&#x27;</span>)</span><br><span class="line">    plaintext=<span class="built_in">input</span>()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密文为:\n%s&quot;</span> % Encrypt(plaintext,T_letter))</span><br><span class="line">  <span class="keyword">else</span>:               <span class="comment">#解密</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;请输入密文:&#x27;</span>)</span><br><span class="line">    ciphertext=<span class="built_in">input</span>()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;明文为:\n%s&#x27;</span> % Decrypt(ciphertext,T_letter))</span><br></pre></td></tr></table></figure>

<h4 id="22、"><a href="#22、" class="headerlink" title="22、"></a>22、</h4><p>先base64再进行rot一个一个试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;v)*L*_F0&lt;&#125;@H0&gt;F49023@FE0#@EN&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rot_n</span>(<span class="params">c</span>):</span><br><span class="line">    </span><br><span class="line">    i = <span class="number">47</span></span><br><span class="line">    <span class="keyword">while</span>(i &lt; <span class="number">50</span>):</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">            <span class="built_in">ascii</span> = <span class="number">0</span></span><br><span class="line">            <span class="built_in">ascii</span> = <span class="built_in">int</span>(<span class="built_in">ord</span>(c[k] )-i)</span><br><span class="line">            ans = ans + <span class="built_in">chr</span>(<span class="built_in">ascii</span>)</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> ans[:<span class="number">3</span>] == <span class="string">&#x27;GXY&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(ans)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">flag = rot_n(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h4 id="23、"><a href="#23、" class="headerlink" title="23、"></a>23、</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = [<span class="number">111</span>,<span class="number">114</span>,<span class="number">157</span>,<span class="number">166</span>,<span class="number">145</span>,<span class="number">123</span>,<span class="number">145</span>,<span class="number">143</span>,<span class="number">165</span>,<span class="number">162</span>,<span class="number">151</span>,<span class="number">164</span>,<span class="number">171</span>,<span class="number">126</span>,<span class="number">145</span>,<span class="number">162</span>,<span class="number">171</span>,<span class="number">115</span>,<span class="number">165</span>,<span class="number">143</span>,<span class="number">150</span>]</span><br><span class="line">ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> temp <span class="keyword">in</span> c:</span><br><span class="line">    ans = ans + <span class="built_in">chr</span>(<span class="built_in">int</span>(<span class="built_in">str</span>(temp),<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></table></figure>

<h4 id="24、Wiener’s-Attack"><a href="#24、Wiener’s-Attack" class="headerlink" title="24、Wiener’s Attack"></a>24、Wiener’s Attack</h4><p>知乎：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/400818185">https://zhuanlan.zhihu.com/p/400818185</a></p>
<h2 id="Day5"><a href="#Day5" class="headerlink" title="Day5"></a>Day5</h2><h4 id="25、这是base？"><a href="#25、这是base？" class="headerlink" title="25、这是base？"></a>25、这是base？</h4><p>bin():返回一个int或者long int的二进制表示</p>
<p>python中的re.findall函数：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36556893/article/details/89182067">https://blog.csdn.net/qq_36556893/article/details/89182067</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">此题则是根据base64编码的规则将密文还原为明文</span></span><br><span class="line"><span class="string">自己慢慢写代码吧</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s1 = &#123;<span class="number">0</span>: <span class="string">&#x27;J&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;K&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;L&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;M&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;N&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;O&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;U&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;V&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;A&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;B&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;C&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;D&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;E&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;F&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;G&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;H&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;P&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;I&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">27</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;g&#x27;</span>, <span class="number">32</span>: <span class="string">&#x27;h&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;k&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;l&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;m&#x27;</span>, <span class="number">38</span>: <span class="string">&#x27;W&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;X&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="number">41</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="number">42</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;2&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;5&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;6&#x27;</span>, <span class="number">49</span>: <span class="string">&#x27;R&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;S&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;T&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;p&#x27;</span>, <span class="number">55</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;s&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">60</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">61</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;+&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;/&#x27;</span>, <span class="number">64</span>: <span class="string">&#x27;=&#x27;</span>&#125;</span><br><span class="line">key_list= []</span><br><span class="line">value_list = []</span><br><span class="line"><span class="keyword">for</span> key,value <span class="keyword">in</span> s1.items():</span><br><span class="line">    key_list.append(key)</span><br><span class="line">    value_list.append(value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">value_to_key</span>(<span class="params">a</span>):</span><br><span class="line">    get_value = a</span><br><span class="line">    <span class="keyword">if</span> get_value <span class="keyword">in</span> value_list:</span><br><span class="line">        get_value_index = value_list.index(get_value)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;base64编码转化中没有这个字符&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span>(get_value_index)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    s2 =  <span class="string">&#x27;FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw&#x27;</span></span><br><span class="line">    ans = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s2:</span><br><span class="line">        ans.append(value_to_key(i))</span><br><span class="line">    <span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">ans = [<span class="number">16</span>, <span class="number">36</span>, <span class="number">41</span>, <span class="number">4</span>, <span class="number">30</span>, <span class="number">52</span>, <span class="number">16</span>, <span class="number">48</span>, <span class="number">23</span>, <span class="number">53</span>, <span class="number">36</span>, <span class="number">48</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">43</span>, <span class="number">19</span>, <span class="number">38</span>, <span class="number">61</span>, <span class="number">23</span>, <span class="number">23</span>, <span class="number">53</span>, <span class="number">17</span>, <span class="number">40</span>, <span class="number">12</span>, <span class="number">23</span>, <span class="number">13</span>, <span class="number">31</span>, <span class="number">24</span>, <span class="number">35</span>, <span class="number">17</span>, <span class="number">51</span>, <span class="number">25</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">45</span>, <span class="number">24</span>, <span class="number">23</span>, <span class="number">1</span>, <span class="number">61</span>]</span><br><span class="line">bin_s = []</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">将每个数字转换为二进制，并只取出后六位</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ans:</span><br><span class="line">    bin_s.append(<span class="built_in">bin</span>(i)[<span class="number">2</span>:])</span><br><span class="line">temp_bin = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> bin_s:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(i) &lt; <span class="number">6</span>):</span><br><span class="line">        i = (<span class="number">6</span>-<span class="built_in">len</span>(i))*<span class="string">&#x27;0&#x27;</span> + i</span><br><span class="line">    temp_bin.append(i)</span><br><span class="line">temp_s = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(temp_bin)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> temp_bin:</span><br><span class="line">    temp_s = temp_s + i</span><br><span class="line"><span class="built_in">print</span>(temp_s)</span><br><span class="line">temp_s2 = re.findall(<span class="string">r&#x27;.&#123;8&#125;&#x27;</span>,temp_s)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(temp_s2)</span><br><span class="line">temp_s3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> temp_s2:</span><br><span class="line">    temp_s3.append(<span class="built_in">int</span>(i,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> temp_s3:</span><br><span class="line">    flag = flag + <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="26、RSA5"><a href="#26、RSA5" class="headerlink" title="26、RSA5"></a>26、RSA5</h4><h5 id="低加密指数广播攻击："><a href="#低加密指数广播攻击：" class="headerlink" title="低加密指数广播攻击："></a>低加密指数广播攻击：</h5><p>特点：e非常小（65537），一份明文m使用不同的模数n，使用相同的e进行多次加密，</p>
<p>此时使用的n都会非常大，一般不能够分解出来，但是因为n只能分解为p*q，在取的模数n足够多的时候，就会难免出现gcd（n1，n2）不等于1的情况，而因为n只有两个因数，所以这个公因数只能为p或者q，根据p，q求出d即可求出明文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line">c1 = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line">c2 = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line">n3 = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line">c3 = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line">n4 = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line">c4 = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line">n5 = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line">c5 = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line">n6 = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line">c6 = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line">n7 = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line">c7 = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line">n8 = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line">c8 = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line">n9 = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line">c9 = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line">n10 = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line">c10 = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line">n11 = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line">c11 = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line">n12 = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line">c12 = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line">n13 = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line">c13 = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line">n14 = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line">c14 = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line">n15 = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line">c15 = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line">n16 = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line">c16 = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line">n17 = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line">c17 = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line">n18 = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line">c18 = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line">n19 = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line">c19 = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line">n20 = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line">c20 = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br><span class="line"></span><br><span class="line">temp1 = [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,n20]</span><br><span class="line">temp2 = [c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">if</span> y &gt; x:</span><br><span class="line">        x,y = y,x</span><br><span class="line">    <span class="keyword">while</span>(x%y != <span class="number">0</span>):</span><br><span class="line">        a = x%y</span><br><span class="line">        x = y</span><br><span class="line">        y = a</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line">p = <span class="number">0</span></span><br><span class="line">N = <span class="number">0</span></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">if</span>(gcd(temp1[i],temp1[j]) != <span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(i,j)</span><br><span class="line">            <span class="built_in">print</span>(gcd(temp1[i],temp1[j]))</span><br><span class="line">            N = temp1[i]</span><br><span class="line">            c = temp2[i]</span><br><span class="line">            p = gcd(temp1[i],temp1[j])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">q = N//p</span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>适用于e和phi_n不互素的情况大佬的具体文章：<a target="_blank" rel="noopener" href="http://www.hackdig.com/03/hack-629174.htm">http://www.hackdig.com/03/hack-629174.htm</a></p>
<p>四方密码：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/253700.html">https://www.freebuf.com/articles/network/253700.html</a></p>

    </div>

    
    
    
      <div>
        
          <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">本文结束，感谢您的阅读</div>
    
</div>

        
      </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/12/21/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E4%B8%8A%E6%9C%BA%E6%8A%A5%E5%91%8A/" rel="prev" title="编译原理上机报告">
      <i class="fa fa-chevron-left"></i> 编译原理上机报告
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/12/21/%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%BB%84%E4%BC%9A/" rel="next" title="第一次组会">
      第一次组会 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%95%99%E6%A0%A1%E5%88%B7%E9%A2%98%E5%96%B5"><span class="nav-number">1.</span> <span class="nav-text">留校刷题喵</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Day1"><span class="nav-number">1.1.</span> <span class="nav-text">Day1</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1%E3%80%81"><span class="nav-number">1.1.0.1.</span> <span class="nav-text">1、</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%B8%AD%E2%80%9C-x3D-%E2%80%9D%E5%8F%B7%E4%BD%9C%E4%B8%BA%E5%A1%AB%E5%85%85%E7%AC%A6%E3%80%82%E5%BE%88%E5%85%B3%E9%94%AE%EF%BC%8C%E8%AF%86%E5%88%ABbase64%E8%A7%A3%E5%AF%86"><span class="nav-number">1.1.0.1.1.</span> <span class="nav-text">其中“&#x3D;”号作为填充符。很关键，识别base64解密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#base%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B%EF%BC%9A%E3%80%81"><span class="nav-number">1.1.0.1.2.</span> <span class="nav-text">base算法实现过程：、</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BD%93%E5%8E%9F%E6%96%87%E7%AC%A6%E5%8F%B7%E6%95%B0%E4%B8%8D%E6%98%AF%E4%B8%89%E7%9A%84%E5%80%8D%E6%95%B0%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%9C%A8%E5%90%8E%E9%9D%A2%E8%A1%A5%E7%AD%89%E4%BA%8E%E5%8F%B7%EF%BC%88binggo%EF%BC%81%EF%BC%89"><span class="nav-number">1.1.0.1.3.</span> <span class="nav-text">当原文符号数不是三的倍数的时候，在后面补等于号（binggo！）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2%E3%80%81URL%E7%BC%96%E7%A0%81%EF%BC%9A%EF%BC%88%E7%99%BE%E5%88%86%E6%AF%94%E7%BC%96%E7%A0%81%EF%BC%89"><span class="nav-number">1.1.0.2.</span> <span class="nav-text">2、URL编码：（百分比编码）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3%E3%80%81ROT13"><span class="nav-number">1.1.0.3.</span> <span class="nav-text">3、ROT13</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4%E3%80%81%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81"><span class="nav-number">1.1.0.4.</span> <span class="nav-text">4、凯撒密码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E8%BD%ACascii%E7%A0%81%EF%BC%9Aord%EF%BC%88%EF%BC%89"><span class="nav-number">1.1.0.4.1.</span> <span class="nav-text">字符转ascii码：ord（）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E8%BD%AC%E5%AD%97%E7%AC%A6%EF%BC%9Achr%EF%BC%88%E6%95%B0%E5%AD%97%EF%BC%89"><span class="nav-number">1.1.0.4.2.</span> <span class="nav-text">数字转字符：chr（数字）</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5%E3%80%81Quoted-printable%E7%BC%96%E7%A0%81"><span class="nav-number">1.1.0.5.</span> <span class="nav-text">5、Quoted-printable编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6%E3%80%81rabbit%E5%8A%A0%E5%AF%86"><span class="nav-number">1.1.0.6.</span> <span class="nav-text">6、rabbit加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7%E3%80%81%E6%A0%85%E6%A0%8F%E5%8A%A0%E5%AF%86"><span class="nav-number">1.1.0.7.</span> <span class="nav-text">7、栅栏加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#8%E3%80%81%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.0.8.</span> <span class="nav-text">8、哈希函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#9%E3%80%81windows%E7%B3%BB%E7%BB%9F%E5%AF%86%E7%A0%81%EF%BC%88hash%E6%96%87%E4%BB%B6%EF%BC%89"><span class="nav-number">1.1.0.9.</span> <span class="nav-text">9、windows系统密码（hash文件）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#windows%E8%AE%A4%E8%AF%81%E4%BD%93%E7%B3%BB%EF%BC%9ANTLM%E8%AE%A4%E8%AF%81"><span class="nav-number">1.1.0.9.1.</span> <span class="nav-text">windows认证体系：NTLM认证</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#10%E3%80%81%E7%8C%AA%E5%9C%88%E5%AF%86%E7%A0%81%EF%BC%88%E8%8D%89%EF%BC%89when-the-pig-want-treat"><span class="nav-number">1.1.0.10.</span> <span class="nav-text">10、猪圈密码（草）when the pig want treat</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Day2"><span class="nav-number">1.2.</span> <span class="nav-text">Day2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11%E3%80%81dp-amp-dq%E6%B3%84%E9%9C%B2"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">11、dp&amp;dq泄露</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="nav-number">1.2.0.2.</span> <span class="nav-text">快速幂算法：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%99%E9%87%8C%E6%98%AF%E4%B8%80%E4%B8%AA%E7%BB%99%E5%87%BAdp%EF%BC%8Cdq%EF%BC%8Cc%EF%BC%8Cp%EF%BC%8Cq%E4%BD%86%E6%98%AF%E5%B9%B6%E6%B2%A1%E6%9C%89%E7%BB%99%E5%87%BAe%E7%9A%84%E9%A2%98%E7%9B%AE%EF%BC%8C%E5%B1%9E%E4%BA%8Edp%E5%92%8Cdq%E5%8F%8C%E6%B3%84%E9%9C%B2%E4%BD%86%E6%98%AF%E5%B9%B6%E6%B2%A1%E6%9C%89%E7%BB%99%E5%AE%9A%E5%AF%86%E9%92%A5"><span class="nav-number">1.2.0.2.1.</span> <span class="nav-text">这里是一个给出dp，dq，c，p，q但是并没有给出e的题目，属于dp和dq双泄露但是并没有给定密钥</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12%E3%80%81%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="nav-number">1.2.0.3.</span> <span class="nav-text">12、共模攻击</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#13%E3%80%81Unencode%E7%BC%96%E7%A0%81%EF%BC%9A"><span class="nav-number">1.2.0.4.</span> <span class="nav-text">13、Unencode编码：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#14%E3%80%81dp%E6%B3%84%E9%9C%B2"><span class="nav-number">1.2.0.5.</span> <span class="nav-text">14、dp泄露</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Day3"><span class="nav-number">1.3.</span> <span class="nav-text">Day3</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15%E3%80%81%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E8%BD%AC%E4%B8%BA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.3.0.1.</span> <span class="nav-text">15、十六进制转为字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#16%E3%80%81"><span class="nav-number">1.3.0.2.</span> <span class="nav-text">16、</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#bytes-from-hex-s"><span class="nav-number">1.3.0.2.1.</span> <span class="nav-text">bytes.from(hex(s))</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#17%E3%80%81%E7%BB%99%E5%87%BA%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6flag-enc-%E5%AF%86%E6%96%87-%E4%BB%A5%E5%8F%8Apub-key-%E5%85%AC%E9%92%A5"><span class="nav-number">1.3.0.3.</span> <span class="nav-text">17、给出两个文件flag.enc(密文)以及pub.key(公钥)</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Day4"><span class="nav-number">2.</span> <span class="nav-text">Day4</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#18%E3%80%81Rsaroll"><span class="nav-number">2.0.0.1.</span> <span class="nav-text">18、Rsaroll</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#19%E3%80%81%E4%BD%8E%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB%EF%BC%88e-x3D-3%EF%BC%89"><span class="nav-number">2.0.0.2.</span> <span class="nav-text">19、低指数攻击（e &#x3D; 3）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#20%E3%80%81babyRSA"><span class="nav-number">2.0.0.3.</span> <span class="nav-text">20、babyRSA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#21%E3%80%81Playfair%E5%8A%A0%E5%AF%86"><span class="nav-number">2.0.0.4.</span> <span class="nav-text">21、Playfair加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#22%E3%80%81"><span class="nav-number">2.0.0.5.</span> <span class="nav-text">22、</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#23%E3%80%81"><span class="nav-number">2.0.0.6.</span> <span class="nav-text">23、</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#24%E3%80%81Wiener%E2%80%99s-Attack"><span class="nav-number">2.0.0.7.</span> <span class="nav-text">24、Wiener’s Attack</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Day5"><span class="nav-number">2.1.</span> <span class="nav-text">Day5</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#25%E3%80%81%E8%BF%99%E6%98%AFbase%EF%BC%9F"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">25、这是base？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#26%E3%80%81RSA5"><span class="nav-number">2.1.0.2.</span> <span class="nav-text">26、RSA5</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB%EF%BC%9A"><span class="nav-number">2.1.0.2.1.</span> <span class="nav-text">低加密指数广播攻击：</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ang"
      src="/images/ang.jpg">
  <p class="site-author-name" itemprop="name">Ang</p>
  <div class="site-description" itemprop="description">Why do learn?</div>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ang-sagapo" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ang-sagapo" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ang</span>
</div>
<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
